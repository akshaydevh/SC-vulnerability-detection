import nodemailer from 'nodemailer';
import config from "@/config";

let transporter = nodemailer.createTransport({
    host: config.SMTP_HOST,
    port: config.SMTP_PORT,
    auth: {
        user: config.SMTP_USERNAME,
        pass: config.SMTP_PASSWORD,
    },
});

const sendMail = async (to, subject, html) => {
    try {
        const mailInfo = await transporter.sendMail({
            from: config.SMTP_USERNAME,
            to: to,
            subject: subject,
            html: html,
        });
        console.log(`Message sent to ${to} with ID: ${mailInfo.messageId}`);
        console.log(`Preview URL: ${nodemailer.getTestMessageUrl(mailInfo)}`)
    } catch (error) {
        console.error("Error sending email:", error);
        throw error;
    }
};

export default {
    sendMail,
    transporter
}